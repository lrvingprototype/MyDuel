<!DOCTYPE html>
<html>
<head>
    <title>テキスト送信</title>
</head>
<body>
    <!-- フォームタグは不要なので削除 -->
    <input type="text" id="messageInput" placeholder="メッセージを入力">
    <button id="sendButton">送信</button> <!-- 送信用のボタンを作成 -->

    <p id="receive"></p>
    <p>メッセージ送信回数: <span id="messageCount">0</span></p>

    <script>
        const ws = new WebSocket('https://myduel.onrender.com');

        ws.onmessage = function(event) {
            console.log(event.data);
            
            const data = JSON.parse(event.data);
            if (data.type === 'message') {
                let enc = new TextDecoder("utf-8");
                let mes = enc.decode(new Uint8Array(data.message.data));
                document.getElementById('receive').innerText = mes;
            }

            if (data.type === 'count') {
                document.getElementById('messageCount').innerText = data.count;
            }
        };

        // 送信ボタンのクリックイベントをリスン
        document.getElementById('sendButton').addEventListener('click', function() {
            const message = document.getElementById('messageInput').value;
            ws.send(message);
            document.getElementById('messageInput').value = ''; // 送信後に入力フィールドをクリア
        });

        // Enterキーを押したときに送信するためのイベントリスナー
        document.getElementById('messageInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // Enterキーのデフォルト動作を無効化
                document.getElementById('sendButton').click(); // ボタンクリックをトリガー
            }
        });
    </script>
</body>
</html>
